function getGPTResponse(e,o,n){let t={model:"gpt-3.5-turbo",messages:[{role:"user",content:o}]},s=JSON.stringify(t);fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:s}).then((e=>e.json())).then((e=>{var o="No response";e.choices&&(o=e.choices[0].message.content),console.log("[Background] sending response: "+o),n({result:o})})).catch((e=>{console.log("error: "+e)}))}chrome.runtime.onInstalled.addListener((()=>{chrome.contextMenus.create({id:"exampleContextMenu",title:"Context Menu",contexts:["selection"]})})),chrome.contextMenus.onClicked.addListener(((e,o)=>{if("exampleContextMenu"===e.menuItemId){const o=e.selectionText;console.log(Date.now(),"Selected text: ",o)}})),chrome.runtime.onMessage.addListener((function(e,o,n){return"getResponse"===e.type&&(console.log("[Background] Getting response"),chrome.storage.local.get(["key"]).then((o=>{const t=o.key.apiKey;console.log("[Background] API_KEY: "+t);const s=e.selection;console.log("[Background] selection: "+s),getGPTResponse(t,s,n)}))),!0})),console.log("[Background] Loaded script");