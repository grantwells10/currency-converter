import{API_KEY}from"./config.js";async function fetchAndCacheRates(){try{const e=`http://api.currencylayer.com/live?access_key=${API_KEY}`,t=await fetch(e);if(!t)throw new Error("Failed to fetch data");const r=await t.json().quotes,n={data:r,timestamp:Date.now()};return await chrome.storage.local.set({exchangeRates:n}),r}catch(e){return console.log(e),null}}async function convertCurrency(e,t,r){const n=await retrieveCache("exchangeRates");let a;return a="USD"===t?n[`USD${r}`]:n[`USD${r}`]/n[`USD${t}`],e*a}async function retrieveCache(){return new Promise(((e,t)=>{chrome.storage.local.get(["exchangeRates"],(function(r){if(chrome.runtime.lastError)return void t(chrome.runtime.lastError);const n=r.exchangeRates;n?Date.now()-n.timestamp>288e5?chrome.storage.local.remove("exchangeRates",(function(){chrome.runtime.lastError?t(chrome.runtime.lastError):e(fetchAndCacheRates())})):e(n.data):e(fetchAndCacheRates())}))}))}async function extractCurrencyAndAmount(e){const t=e.match(/[A-Z]{3}/),r=e.match(/[\d,]+\.?\d*/);let n=null;return r&&(n=parseFloat(r[0].replace(/,/g,""))),{currency:t?t[0]:null,number:n||null}}function createPopup(e,t){var r=document.createElement("div");r.style.position="fixed",r.style.top=t.top-50+"px",r.style.left=t.left+"px",r.style.backgroundColor="#fff",r.style.border="1px solid #000",r.style.padding="10px";var n=document.createElement("div");return n.textContent=e,r.appendChild(n),r.id="myPopup",r}console.log("[Content] this is content script");